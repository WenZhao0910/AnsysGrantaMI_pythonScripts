

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Streamlined API performance tuning &mdash; MI Scripting Toolkit for Python 2.3.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/Materials.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="Using OpenID Connect with MI Scripting Toolkit" href="20_Using_OIDC_With_the_STK.html" />
    <link rel="prev" title="Asynchronous Job Queue" href="18_Async_Job_Queue.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/Materials-STK.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../welcome.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">What’s new in Version 2.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../upgrading.html">Upgrading from earlier versions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../stream_example.html">Streamlined API Example Notebooks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="00_Get_Started.html">Get Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="01_Get_Attributes.html">Get Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_Browse_MI.html">Browse Granta MI</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_Search_MI.html">Search Granta MI</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_Fetch_Attribute_Data_in_Bulk.html">Fetch Attribute Data in Bulk</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_Edit_Data.html">Edit Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_Create_Records.html">Create Records</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_Import_Functional_Data.html">Import Functional Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_Create_Functional_Data.html">Create Functional Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="09_Edit_Tabular_Data.html">Edit Tabular Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_Edit_Pseudo-attributes.html">Edit Pseudo-attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_Add_Files_Pictures_and_Hyperlinks.html">Add Files, Pictures, and Hyperlinks</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_Add_Point_Range_Data.html">Add Point and Range data</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_Add_Date_Integer_and_Logical_Data.html">Add Date, Integer and Logical data</a></li>
<li class="toctree-l2"><a class="reference internal" href="14_Create_and_Edit_Tabular_Data.html">Create and Edit Tabular Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="15_Use_Exporters_for_FEA_Export.html">Export data for FEA</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_Link_Records.html">Link Records</a></li>
<li class="toctree-l2"><a class="reference internal" href="17_Layouts.html">Layouts</a></li>
<li class="toctree-l2"><a class="reference internal" href="18_Async_Job_Queue.html">Asynchronous Job Queue</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Streamlined API performance tuning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Disclaimer">Disclaimer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Establishing-a-Session">Establishing a Session</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Locating-records">Locating records</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Creating-records">Creating records</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Accessing-attributes-and-links">Accessing attributes and links</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Import-records">Import records</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Deleting-records-&amp;-release-states">Deleting records &amp; release states</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="20_Using_OIDC_With_the_STK.html">Using OpenID Connect with MI Scripting Toolkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="21_Logging.html">Logging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../stream_api.html">Streamlined API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../foundation_example.html">Foundation API Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GRANTA_MIScriptingToolkit.html">Foundation API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_analytics.html">Data Analytics Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../log_files.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../copyright.html">Copyright and Trademark Information</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MI Scripting Toolkit for Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../stream_example.html">Streamlined API Example Notebooks</a> &raquo;</li>
        
      <li>Streamlined API performance tuning</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<a href="../../samples\streamlined\19_Streamlined_API_performance_tuning.ipynb" id='example' type="application/octet-stream" download>
View the .ipynb file.
</a><hr class="docutils" />
<div class="section" id="Streamlined-API-performance-tuning">
<h1>Streamlined API performance tuning<a class="headerlink" href="#Streamlined-API-performance-tuning" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h2>
<p>This Notebook provides some tips and tricks on improving the performance of the Streamlined API.</p>
<p>The Streamlined API is a productivity layer that wraps the Foundation Layer. It typically loads a lot of information for the user in anticipation that the user will need it, which makes exploratory work in interactive sessions (such as in Jupyter Notebooks) very powerful as a tool. The examples below show some coding approaches that may improve the speed and performance of your programs.</p>
</div>
<div class="section" id="Disclaimer">
<h2>Disclaimer<a class="headerlink" href="#Disclaimer" title="Permalink to this headline">¶</a></h2>
<p>Execution times for some of the functions are shown, however, note that performance depends fundamentally on your hardware setup and connection speed, and on previously-executed code in the same Notebook, amongst other factors. We cannot guarantee that the saved outputs in this Notebook will match what you will see, and they are intended primarily as a guide rather than a benchmark.</p>
</div>
<div class="section" id="Establishing-a-Session">
<h2>Establishing a Session<a class="headerlink" href="#Establishing-a-Session" title="Permalink to this headline">¶</a></h2>
<p>The first steps in any MI Scripting Toolkit script are to make a connection to a Granta MI Service Layer, then fetch a database and table. The three objects, and the fastest ways of acquiring them, are as follows:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Session</span></code> - <code class="docutils literal notranslate"><span class="pre">mpy.connect()</span></code> is the fastest way to create a session.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Database</span></code> - <code class="docutils literal notranslate"><span class="pre">Session.get_db()</span></code> is the fastest way to fetch a database</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Table</span></code> - <code class="docutils literal notranslate"><span class="pre">Database.get_table()</span></code> is the fastest way to fetch a table</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">get_db</span></code> and <code class="docutils literal notranslate"><span class="pre">get_table</span></code>, however, actually fetch <em>all</em> the databases and <em>all</em> the tables (for the selected database) and just return the one that was asked for. The results are then cached; this means those calls to the Service Layer will not be repeated when the objects are accessed again. You can see the effect of this when re-running the cell below multiple times.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">GRANTA_MIScriptingToolkit</span> <span class="kn">import</span> <span class="n">granta</span> <span class="k">as</span> <span class="n">mpy</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">mpy</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;http://localhost/mi_servicelayer&#39;</span><span class="p">,</span> <span class="n">autologon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># all tables &amp; databases are cached when requested</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_db</span><span class="p">(</span><span class="n">db_key</span><span class="o">=</span><span class="s1">&#39;MI_Training&#39;</span><span class="p">)</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="s1">&#39;Design Data&#39;</span><span class="p">)</span>
<span class="n">milestone1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_db</span><span class="p">(</span><span class="n">db_key</span><span class="o">=</span><span class="s1">&#39;MI_Training&#39;</span><span class="p">)</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="s1">&#39;Design Data&#39;</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed to reach the first milestone&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">milestone1</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed between milestone 1 and the end&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">milestone1</span><span class="p">))</span>

<span class="c1"># ALL are cached, so subsequent requests for different tables will still be quick.</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="s1">&#39;MaterialUniverse&#39;</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed getting the MaterialUniverse table&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">milestone1</span><span class="p">))</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.2328 s - Time elapsed to reach the first milestone
0.0010 s - Time elapsed between milestone 1 and the end
0.0020 s - Time elapsed getting the MaterialUniverse table
</pre></div></div>
</div>
</div>
<div class="section" id="Locating-records">
<h2>Locating records<a class="headerlink" href="#Locating-records" title="Permalink to this headline">¶</a></h2>
<p>There are many search methods in the Streamlined API and all of them make a single Service Layer call when executed.</p>
<p>There are, however, some methods that get records from a table and also populate caches which can be useful. For example, if you have some very specific filtering that you want to apply to all records that cannot be found using the existing functionality, such as a list of all records with 3 or more children. In this case, you could use <code class="docutils literal notranslate"><span class="pre">Table.all_records()</span></code> to return a list of all records in the table and populate the children of each record, in one call. You would then apply your own search
filters to the record list to execute a search.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">recs</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">all_records</span><span class="p">(</span><span class="n">include_folders</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_generics</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">milestone1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">filtered_recs</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recs</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">children</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed to reach the first milestone&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">milestone1</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed between milestone 1 and the end&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">milestone1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.3529 s - Time elapsed to reach the first milestone
0.0000 s - Time elapsed between milestone 1 and the end
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">filtered_recs</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;Record long name:Alumino silicate glass&gt;,
 &lt;Record long name:Glasses&gt;,
 &lt;Record long name:Ceramics and glasses&gt;,
 &lt;Record long name:Wrought&gt;,
 &lt;Record long name:Low alloy steel&gt;,
 &lt;Record long name:Ferrous alloys&gt;,
 &lt;Record long name:Wrought aluminum alloy&gt;,
 &lt;Record long name:Aluminum&gt;,
 &lt;Record long name:Titanium alpha-beta alloy&gt;,
 &lt;Record long name:Titanium&gt;,
 &lt;Record long name:Non-ferrous alloys&gt;,
 &lt;Record long name:Metals and alloys&gt;,
 &lt;Record long name:PVC-elastomer (Polyvinyl Chloride elastomer)&gt;,
 &lt;Record long name:Thermoplastic elastomers (TPE)&gt;,
 &lt;Record long name:Elastomers&gt;,
 &lt;Record long name:ABS - unfilled&gt;,
 &lt;Record long name:PMMA - unfilled&gt;,
 &lt;Record long name:PMMA - unfilled&gt;,
 &lt;Record long name:Thermoplastics&gt;,
 &lt;Record long name:Plastics&gt;,
 &lt;Record long name:Polymers: plastics, elastomers&gt;]
</pre></div></div>
</div>
</div>
<div class="section" id="Creating-records">
<h2>Creating records<a class="headerlink" href="#Creating-records" title="Permalink to this headline">¶</a></h2>
<p>Records are normally created using the <code class="docutils literal notranslate"><span class="pre">table</span></code> object through <code class="docutils literal notranslate"><span class="pre">Table.create_record</span></code>, however, when creating a record at a specific (known) location in the tree, it can be time consuming to fetch the record objects in the path needed to assign the correct parent. For this use case, we have added two methods which take a path (or paths) through the tree and traverse it, creating any nodes that don’t already exist along the way.</p>
<p>These two methods exist on the <code class="docutils literal notranslate"><span class="pre">Table</span></code> object:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Table.path_from</span></code> - Check for the existence of a path through the table and create it if it does not exist</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Table.paths_from</span></code> - Create multiple paths in one call</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="c1"># create a new top-level record</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="s1">&#39;Training Exercise for Import&#39;</span><span class="p">)</span>
<span class="n">rec</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="n">tab</span><span class="o">.</span><span class="n">create_record</span><span class="p">(</span><span class="s1">&#39;Top-level folder </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())),</span> <span class="n">folder</span><span class="o">=</span><span class="kc">True</span><span class="p">)],</span>
                                   <span class="n">refresh_attributes</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">rec</span><span class="o">.</span><span class="n">children</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">end_leaf</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">path_from</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;our&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span><span class="p">],</span> <span class="n">end_node</span><span class="o">=</span><span class="s1">&#39;and optional record&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Fuchsia&#39;</span><span class="p">)</span>
<span class="n">end_leaf</span><span class="o">.</span><span class="n">path</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;Top-level folder 2021-07-15 10:55:36.663001&#39;, &#39;our&#39;, &#39;new&#39;, &#39;path&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># any folders that already exist in a path will not be altered, even if we alter the arguments</span>
<span class="n">end_leaf</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">path_from</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;our&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="s1">&#39;route&#39;</span><span class="p">],</span> <span class="n">end_node</span><span class="o">=</span><span class="s1">&#39;and optional record&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Silver&#39;</span><span class="p">)</span>
<span class="n">end_leaf</span><span class="o">.</span><span class="n">path</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;Top-level folder 2021-07-15 10:55:36.663001&#39;, &#39;our&#39;, &#39;new&#39;, &#39;route&#39;]
</pre></div></div>
</div>
</div>
<div class="section" id="Accessing-attributes-and-links">
<h2>Accessing attributes and links<a class="headerlink" href="#Accessing-attributes-and-links" title="Permalink to this headline">¶</a></h2>
<p>The first time you call <code class="docutils literal notranslate"><span class="pre">Record.attributes</span></code>, the Streamlined API checks to see if the <code class="docutils literal notranslate"><span class="pre">attributes</span></code> property has been populated yet. If not, it will automatically populate it with all the attributes on the record. This is inefficient if you are only interested in one or two attributes. The same is true of <code class="docutils literal notranslate"><span class="pre">links</span></code>. We provide two <code class="docutils literal notranslate"><span class="pre">Table</span></code> methods which can be used to ensure only the objects you are interested in are fetched.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Table.bulk_fetch</span></code> - fetches specified attributes for specified records</p>
<ul>
<li><p>If an attribute is not populated, an empty attribute object is added to the dictionary instead</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Table.bulk_link_fetch</span></code> - fetches specified link groups for specified records</p></li>
</ul>
<p>These will fetch data for <em>just</em> the attributes and records you specify; the properties will be populated in the record objects you provide and the methods do not return anything.</p>
<p>The most efficient way to access attributes and links is using these two methods.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tab</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="s1">&#39;MaterialUniverse&#39;</span><span class="p">)</span>
<span class="n">recs</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">all_records</span><span class="p">()</span>

<span class="c1"># bulk_fetch (&amp; all the bulk_xxx methods) can be parallelized by the MI Scripting Toolkit IF you have the cores available</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="c1"># populate all attributes on every record</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recs</span><span class="p">:</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">attributes</span>
    <span class="n">r</span><span class="o">.</span><span class="n">decache_attributes</span>
<span class="n">milestone1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># populate all attributes on every record using bulk_fetch</span>
<span class="n">tab</span><span class="o">.</span><span class="n">bulk_fetch</span><span class="p">(</span><span class="n">recs</span><span class="p">)</span>

<span class="n">milestone2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="c1"># just populate Base and Young&#39;s Modulus on every record</span>
<span class="n">tab</span><span class="o">.</span><span class="n">bulk_fetch</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Base&#39;</span><span class="p">,</span> <span class="s2">&quot;Young&#39;s modulus&quot;</span><span class="p">],</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">parallelise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">milestone3</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="c1"># Parallelise the previous command</span>
<span class="n">tab</span><span class="o">.</span><span class="n">bulk_fetch</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Base&#39;</span><span class="p">,</span> <span class="s2">&quot;Young&#39;s modulus&quot;</span><span class="p">],</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">parallelise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_num_threads</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed to reach the first milestone&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">milestone1</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed between milestone 1 and 2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">milestone2</span> <span class="o">-</span> <span class="n">milestone1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed between milestone 2 and 3&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">milestone3</span> <span class="o">-</span> <span class="n">milestone2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed between milestone 2 and the end&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">milestone3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
16.9709 s - Time elapsed to reach the first milestone
3.7195 s - Time elapsed between milestone 1 and 2
1.7777 s - Time elapsed between milestone 2 and 3
0.6435 s - Time elapsed between milestone 2 and the end
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;Base&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;Young</span><span class="se">\&#39;</span><span class="s1">s modulus&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;Oxide&#39;] {&#39;low&#39;: 84.8, &#39;high&#39;: 89.1} Alumino silicate - 1720
[&#39;Oxide&#39;] {&#39;low&#39;: 83.9, &#39;high&#39;: 88.1} Alumino silicate - 1723
[&#39;Oxide&#39;] {&#39;low&#39;: 84.0, &#39;high&#39;: 88.0} Lithium aluminosilicate
[&#39;Oxide&#39;] {&#39;low&#39;: 57.3, &#39;high&#39;: 75.9} Soda barium glass
[&#39;Oxide&#39;] {&#39;low&#39;: 66.30000305175781, &#39;high&#39;: 69.69999694824219} Barium silicate
None {&#39;low&#39;: 599.9999999999997, &#39;high&#39;: 670.0000000000003} Tungsten carbide
[&#39;Fe (Iron)&#39;] {&#39;low&#39;: 183.0, &#39;high&#39;: 192.38461303710938} 250 maraging steel, maraged at 900F
[&#39;Fe (Iron)&#39;] {&#39;low&#39;: 200.0, &#39;high&#39;: 210.25640869140625} Low alloy steel, AISI 4130, air melted, normalized
[&#39;Fe (Iron)&#39;] {&#39;low&#39;: 200.0, &#39;high&#39;: 210.25640869140625} Low alloy steel, AISI 4130, air melted, quenched &amp; tempered
[&#39;Al (Aluminum)&#39;] {&#39;low&#39;: 69.0, &#39;high&#39;: 76.0} Aluminum, 7075, wrought, T6
[&#39;Al (Aluminum)&#39;] {&#39;low&#39;: 69.0, &#39;high&#39;: 72.53845977783203} Aluminum, 7075, wrought, T73
[&#39;Ti (Titanium)&#39;] {&#39;low&#39;: 111.0, &#39;high&#39;: 119.0} Titanium, alpha-beta alloy, Ti-6Al-4V, aged
[&#39;Ti (Titanium)&#39;] {&#39;low&#39;: 110.0, &#39;high&#39;: 119.0} Titanium, alpha-beta alloy, Ti-6Al-4V, annealed, generic
[&#39;Ti (Titanium)&#39;] {&#39;low&#39;: 110.0, &#39;high&#39;: 117.0} Titanium, alpha-beta alloy, Ti-6Al-4V, solution treated &amp; aged
[&#39;Polymer&#39;] {&#39;low&#39;: 0.0006011593504808843, &#39;high&#39;: 0.0009381033014506102} PVC-elastomer (Shore A35)
[&#39;Polymer&#39;] {&#39;low&#39;: 0.002864203881472349, &#39;high&#39;: 0.0029362563509494066} PVC-elastomer (Shore A55)
[&#39;Polymer&#39;] {&#39;low&#39;: 0.00871698185801506, &#39;high&#39;: 0.011692171916365623} PVC-elastomer (Shore A75)
[&#39;Polymer&#39;] {&#39;low&#39;: 0.0035647887270897627, &#39;high&#39;: 0.005562817677855492} PVC-elastomer (Shore A75, flame retarded)
[&#39;Polymer&#39;] {&#39;low&#39;: 12.399999618530273, &#39;high&#39;: 13.800000190734863} ABS (20% carbon fiber, EMI shielding, conductive)
[&#39;Polymer&#39;] {&#39;low&#39;: 5.099999904632568, &#39;high&#39;: 6.070000171661377} ABS (20% glass fiber, injection molding)
[&#39;Polymer&#39;] {&#39;low&#39;: 5.796008586883545, &#39;high&#39;: 6.0} ABS (20% glass fiber, injection molding, flame retarded)
[&#39;Polymer&#39;] {&#39;low&#39;: 6.800000190734863, &#39;high&#39;: 8.300000190734863} ABS (30% glass fiber, injection molding)
[&#39;Polymer&#39;] {&#39;low&#39;: 2.0, &#39;high&#39;: 2.9000000953674316} ABS (extrusion)
[&#39;Polymer&#39;] {&#39;low&#39;: 1.9500000476837158, &#39;high&#39;: 2.049999952316284} ABS (transparent, injection molding)
[&#39;Polymer&#39;] {&#39;low&#39;: 2.700000047683716, &#39;high&#39;: 2.9000000953674316} PMMA (cast sheet)
[&#39;Polymer&#39;] {&#39;low&#39;: 2.4100000858306885, &#39;high&#39;: 3.799999952316284} PMMA (heat resistant)
[&#39;Polymer&#39;] {&#39;low&#39;: 1.600000023841858, &#39;high&#39;: 3.299999952316284} PMMA (impact modified)
[&#39;Polymer&#39;] {&#39;low&#39;: 2.240000009536743, &#39;high&#39;: 3.240000009536743} PMMA (molding and extrusion)
None None PMMA - unfilled
[&#39;Other&#39;] {&#39;low&#39;: 0.10000000149011612, &#39;high&#39;: 0.5} Leather
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tab</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="s1">&#39;Metals Pedigree&#39;</span><span class="p">)</span>
<span class="n">recs</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">all_records</span><span class="p">(</span><span class="n">include_folders</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># manually fetch the links on each record, one record at a time</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recs</span><span class="p">:</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">links</span>
    <span class="n">r</span><span class="o">.</span><span class="n">decache_links</span>
<span class="n">milestone1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># bulk fetch all links on every record</span>
<span class="n">tab</span><span class="o">.</span><span class="n">bulk_link_fetch</span><span class="p">(</span><span class="n">recs</span><span class="p">)</span>

<span class="n">milestone2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># bulk_fetch (&amp; all the bulk_xxx methods) can be parallelized by the MI Scripting Toolkit IF you have the cores available</span>
<span class="n">tab</span><span class="o">.</span><span class="n">bulk_link_fetch</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span>
                    <span class="n">link_groups</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Tensile Test Data&#39;</span><span class="p">],</span>
                    <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                    <span class="n">parallelise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">milestone3</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># parallelise</span>
<span class="n">tab</span><span class="o">.</span><span class="n">bulk_link_fetch</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span>
                    <span class="n">link_groups</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Tensile Test Data&#39;</span><span class="p">],</span>
                    <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                    <span class="n">parallelise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">max_num_threads</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed to reach the first milestone&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">milestone1</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed between milestone 1 and 2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">milestone2</span> <span class="o">-</span> <span class="n">milestone1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed between milestone 2 and 3&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">milestone3</span> <span class="o">-</span> <span class="n">milestone2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed between milestone 2 and the end&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">milestone3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3.7593 s - Time elapsed to reach the first milestone
0.8780 s - Time elapsed between milestone 1 and 2
2.4521 s - Time elapsed between milestone 2 and 3
0.9590 s - Time elapsed between milestone 2 and the end
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> links on record &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">links</span><span class="p">[</span><span class="s1">&#39;Tensile Test Data&#39;</span><span class="p">]),</span> <span class="n">r</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
40 links on record &#34;Batch 948&#34;
36 links on record &#34;Batch 943&#34;
36 links on record &#34;Batch 921&#34;
32 links on record &#34;Batch 978&#34;
0 links on record &#34;2X2301A&#34;
</pre></div></div>
</div>
</div>
<div class="section" id="Import-records">
<h2>Import records<a class="headerlink" href="#Import-records" title="Permalink to this headline">¶</a></h2>
<p>There is one method to import/update records: <code class="docutils literal notranslate"><span class="pre">Session.update</span></code>. In MI Scripting Toolkit 2.1, we added an additional argument which can be used to streamline calls to <code class="docutils literal notranslate"><span class="pre">Session.update</span></code> in specific cases. Normally, after importing records, the MI Scripting Toolkit will fetch the newly imported data on those records to return the results of your changes back to you. However, if you set <code class="docutils literal notranslate"><span class="pre">refresh_attributes</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>, it won’t do this, and you can fetch attributes you’re interested in (if
you want to) using <code class="docutils literal notranslate"><span class="pre">bulk_fetch</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tab</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="s1">&#39;MaterialUniverse&#39;</span><span class="p">)</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="c1"># Let&#39;s create a record and give it some data on a single attribute</span>
<span class="n">new_rec1</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">create_record</span><span class="p">(</span><span class="s1">&#39;My new record </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())))</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">new_rec1</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;Density&#39;</span><span class="p">]</span>
<span class="n">a</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.3</span><span class="p">]</span>
<span class="n">new_rec1</span><span class="o">.</span><span class="n">set_attributes</span><span class="p">([</span><span class="n">a</span><span class="p">])</span>
<span class="c1"># This will re-fetch the record&#39;s attributes after setting them, in case anything has changed on the server!</span>
<span class="n">new_rec1</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="n">new_rec1</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">milestone1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># Do the same again</span>
<span class="n">new_rec2</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">create_record</span><span class="p">(</span><span class="s1">&#39;My new record </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())))</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">new_rec2</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;Density&#39;</span><span class="p">]</span>
<span class="n">a</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.3</span><span class="p">]</span>
<span class="n">new_rec2</span><span class="o">.</span><span class="n">set_attributes</span><span class="p">([</span><span class="n">a</span><span class="p">])</span>
<span class="c1"># This time we won&#39;t refetch the attributes because we only care about the attribute we edited: &#39;Density&#39;</span>
<span class="n">new_rec2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="n">new_rec2</span><span class="p">],</span> <span class="n">refresh_attributes</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Instead we do it ourselves in an additional line of code</span>
<span class="n">tab</span><span class="o">.</span><span class="n">bulk_fetch</span><span class="p">([</span><span class="n">new_rec2</span><span class="p">],</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Density&#39;</span><span class="p">])</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># How long did both processes take?</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed to reach the first milestone&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">milestone1</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time elapsed between milestone 1 and the end&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">milestone1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.6325 s - Time elapsed to reach the first milestone
0.3006 s - Time elapsed between milestone 1 and the end
</pre></div></div>
</div>
</div>
<div class="section" id="Deleting-records-&amp;-release-states">
<h2>Deleting records &amp; release states<a class="headerlink" href="#Deleting-records-&-release-states" title="Permalink to this headline">¶</a></h2>
<p>In addition to the methods shown above, record deletion and fetching of release states can also be performed in bulk. Unlike link fetching and attribute fetching, these are <strong>NOT</strong> table-specific methods, and so they exist as methods on the <code class="docutils literal notranslate"><span class="pre">Session</span></code> class. This means, for example, that records can be deleted from multiple tables and databases simultaneously. Both <code class="docutils literal notranslate"><span class="pre">Session</span></code>-level bulk methods can be parallelized and batched like their <code class="docutils literal notranslate"><span class="pre">Table</span></code>-level siblings. The two methods are called:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Session.bulk_fetch_release_states</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Session.bulk_delete_or_withdraw_records</span></code></p></li>
</ol>
<p>On the whole, these methods are less pervasive, but are still worth demonstrating should you ever need to use them!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Let&#39;s take some of the record&#39;s we&#39;ve created in this example, fetch their release states, then delete them!</span>
<span class="c1"># but let&#39;s split them into two batches, and compare the times taken doing things individually versus in bulk</span>
<span class="n">individuals</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_rec1</span><span class="p">,</span> <span class="n">new_rec2</span><span class="p">]</span>
<span class="n">bulk_batch</span> <span class="o">=</span> <span class="p">[</span><span class="n">end_leaf</span><span class="p">,</span> <span class="n">rec</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Individual Records &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; ------------------ &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">individuals</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">release_state</span><span class="p">)</span>
<span class="n">milestone1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">individuals</span><span class="p">:</span>
    <span class="n">r</span><span class="o">.</span><span class="n">delete_or_withdraw_record_on_server</span><span class="p">()</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time to fetch release states&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">milestone1</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time to manually delete the records&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">milestone1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Bulk batched Records &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; -------------------- &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">bulk_fetch_release_states</span><span class="p">(</span><span class="n">bulk_batch</span><span class="p">)</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">bulk_batch</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">release_state</span><span class="p">)</span>
<span class="n">milestone1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">bulk_delete_or_withdraw_records</span><span class="p">(</span><span class="n">bulk_batch</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time to bulk fetch release states&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">milestone1</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.4f}</span><span class="s1"> s - Time to bulk delete the records&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">milestone1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 Individual Records
 ------------------

Unversioned
Unversioned
0.1077 s - Time to fetch release states
0.3250 s - Time to manually delete the records

 Bulk batched Records
 --------------------

Unversioned
Unversioned
0.1952 s - Time to bulk fetch release states
0.8917 s - Time to bulk delete the records
</pre></div></div>
</div>
</div>
<div class="section" id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Permalink to this headline">¶</a></h2>
<p>The optimizations shown above are not significant when working with small amounts of data, and the ease of use provided by the Streamlined API makes it a very powerful tool for small operations. However, as you scale up the operations being undertaken to hundreds, thousands, and tens of thousands of records, the time saved by using these more efficient methods becomes more significant.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="20_Using_OIDC_With_the_STK.html" class="btn btn-neutral float-right" title="Using OpenID Connect with MI Scripting Toolkit" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="18_Async_Job_Queue.html" class="btn btn-neutral float-left" title="Asynchronous Job Queue" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; <a href="../../copyright.html">Copyright</a> 2021 ANSYS, Inc. or its affiliated companies. All rights reserved.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>